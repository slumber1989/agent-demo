import{dA as e,dB as S,dC as a,ch as A,u as W,r as p,d as v,f as Y,j as k,D as j,T as F}from"./index-ChJwsExv.js";const H=[{spaceType:A.PERSONAL,roleType:a.OWNER,modulePermissions:[{module:S.SPACE,operations:[e.MANAGE,e.DELETE,e.VIEW,e.SPACE_SETTINGS,e.ADD_MEMBERS,e.REMOVE_MEMBERS,e.INVITATION_MANAGE,e.MODIFY_MEMBER_PERMISSIONS,e.SPACE_DELETE],restrictions:{ownResourcesOnly:!0}}]},{spaceType:A.PERSONAL,roleType:a.ADMIN,modulePermissions:[{module:S.SPACE,operations:[e.MANAGE,e.DELETE,e.VIEW,e.ADD_MEMBERS,e.REMOVE_MEMBERS,e.INVITATION_MANAGE,e.MODIFY_MEMBER_PERMISSIONS,e.SPACE_DELETE],restrictions:{ownResourcesOnly:!0}}]},{spaceType:A.PERSONAL,roleType:a.MEMBER,modulePermissions:[{module:S.SPACE,operations:[e.MANAGE,e.VIEW,e.SPACE_DELETE]}]}],$=[{spaceType:A.ENTERPRISE,roleType:a.SUPER_ADMIN,modulePermissions:[{module:S.SPACE,operations:[e.MANAGE,e.VIEW,e.CREATE,e.ENTERPRISE_EDIT,e.DELETE,e.SPACE_SETTINGS,e.SPACE_TRANSFER,e.SPACE_DELETE,e.MODIFY_MEMBER_PERMISSIONS,e.ADD_MEMBERS,e.REMOVE_MEMBERS,e.ALL_RESOURCES_ACCESS,e.INVITATION_MANAGE,e.APPLY_MANAGE],restrictions:{ownResourcesOnly:!0}}]},{spaceType:A.ENTERPRISE,roleType:a.ADMIN,modulePermissions:[{module:S.SPACE,operations:[e.MANAGE,e.VIEW,e.CREATE,e.SPACE_DELETE,e.MODIFY_MEMBER_PERMISSIONS,e.ADD_MEMBERS,e.REMOVE_MEMBERS,e.ALL_RESOURCES_ACCESS,e.INVITATION_MANAGE,e.APPLY_MANAGE,e.LEAVE_ENTERPRISE],restrictions:{ownResourcesOnly:!0}}]},{spaceType:A.ENTERPRISE,roleType:a.MEMBER,modulePermissions:[{module:S.SPACE,operations:[e.MANAGE,e.VIEW,e.SPACE_DELETE,e.LEAVE_ENTERPRISE,e.ALL_RESOURCES_ACCESS]}]}];S.SPACE,e.ALL_RESOURCES_ACCESS,S.SPACE,e.ALL_RESOURCES_ACCESS;const q=[...H,...$];function f(s,t){return q.find(o=>o.spaceType===s&&o.roleType===t)}function J(s,t,o){const u=f(s.spaceType,s.roleType);if(!u)return!1;const E=u.modulePermissions.find(r=>r.module===t);return E?E.operations.includes(o):!1}function ie(s){const t=f(s.spaceType,s.roleType);return t?t.modulePermissions.map(o=>o.module):[]}function K(s,t,o,u){const E=f(s.spaceType,s.roleType);if(!E)return!1;const r=E.modulePermissions.find(_=>_.module===t);return r!=null&&r.restrictions&&r.restrictions.ownResourcesOnly?o===u:!0}var M=(s=>(s.HIDE="hide",s.DISABLE="disable",s))(M||{});const Q="_spaceButton_16kzg_1",X="_danger_16kzg_38",Z="_loading_16kzg_72",ee="_withIcon_16kzg_75",se="_inGroup_16kzg_80",ne="_standalone_16kzg_83",te="_tooltip_16kzg_138",i={spaceButton:Q,"ant-btn-link":"_ant-btn-link_16kzg_12","ant-btn-text":"_ant-btn-text_16kzg_12","size-large":"_size-large_16kzg_17","size-middle":"_size-middle_16kzg_21","size-small":"_size-small_16kzg_25","ant-btn-default":"_ant-btn-default_16kzg_35",danger:X,"ant-btn-primary":"_ant-btn-primary_16kzg_38",loading:Z,withIcon:ee,inGroup:se,standalone:ne,tooltip:te,"ant-tooltip-inner":"_ant-tooltip-inner_16kzg_138"},oe=()=>{const{user:s}=W(),t=p.useMemo(()=>s.roleType===a.SUPER_ADMIN,[s]),o=p.useMemo(()=>s.roleType===a.OWNER,[s]),u=p.useMemo(()=>s.roleType===a.ADMIN,[s]),E=p.useMemo(()=>s.roleType===a.MEMBER,[s]),r=p.useMemo(()=>{const{spaceType:m,roleType:R}=s;return{spaceType:m,roleType:R}},[s]),_=p.useMemo(()=>s.expiresAt&&s.expiresAt<Date.now(),[s]);return p.useMemo(()=>({isSuperAdmin:t,isAdmin:u,isMember:E,isOwner:o,permissionParams:r,isExpires:_}),[t,u,E,o,r,_])},ae=({config:s,userRole:t,className:o,style:u,size:E,onClick:r,inGroup:_=!1,defaultPermissionFailureBehavior:N=M.DISABLE})=>{const{permissionParams:m}=oe(),{t:R}=v();let c=t;c||(c=m);const{key:T,text:z,icon:y,type:I="default",size:b,disabled:h=!1,tooltip:C,danger:O=!1,loading:P=!1,permission:n,visible:d}=s,V=()=>{if(!n||!c)return!0;if(n.customCheck)return n.customCheck(c);if(n.module&&n.operation){if(!J(c,n.module,n.operation))return!1;if(n.resourceOwnerId&&n.currentUserId)return K(c,n.module,n.resourceOwnerId,n.currentUserId)}return!0},G=()=>d===void 0?!0:typeof d=="boolean"?d:typeof d=="function"&&c?d(c):!0,D=V();if(!G())return null;const g=(n==null?void 0:n.failureBehavior)||N;if(!D&&g===M.HIDE)return null;const B=h||P||!D&&g===M.DISABLE,w=l=>{B||(s.onClick?s.onClick(T,l):r&&r(T,l))},U=Y(i.spaceButton,{[i.inGroup]:_,[i.standalone]:!_,[i.withIcon]:!!y,[i.loading]:P,[i.danger]:O,[i[`ant-btn-${I}`]]:!0,[i[`size-${b||E||"middle"}`]]:!0,[i.addMemberBtn]:I==="primary"},o),x=l=>l?l.includes(".")&&!/^\d+\.\d+/.test(l)?R(l):l:"",L=k.jsx(j,{type:I,icon:y,disabled:B,danger:O,loading:P,onClick:w,className:U,style:u,children:x(z)},T);return C?k.jsx(F,{title:C,placement:"top",overlayClassName:i.tooltip,mouseEnterDelay:.3,mouseLeaveDelay:.1,children:L}):L};export{M as P,ae as S,ie as a,K as c,f as g,J as h,oe as u};
